---
title: "Overview"
author: "Jeffrey B. Arnold"
date: "July 27, 2015"
output:
  html_document:
    md_extensions: +pipe_tables+simple_tables
---

$$
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\Var}{Var}
$$

# Model Terminology

These models are called either state space models (econometrics) or
dynamic (linear) models (statistics / Bayesian).

# Using Derivations from Durbin / Koopmans

The state space model 

$$
\begin{aligned}[t]
y_t &= Z_t \alpha_t + d_t \epsilon_t & \epsilon_t & \sim N(0, H_t) & & \text{Observation equation} \\
\alpha_{t + 1} &= T_t \alpha_t + c_t +  R_t \eta_t & \eta_t &\sim N(0, Q_t) & t = 1, \dots, n & \text{State equation} \\
\alpha_1 & \sim N(a_1, P_1)
\end{aligned}
$$

Can define $\eta^*_t = R_t \eta_t$, and $Q^*_t = R_t Q_t R'_t$, but keeping $R$ and $Q$ separate is useful if $Q$ is singular.

--------------  ---------------------------------
$p$             number of observations 
$m$             number of states       
$r$             number of system innovations 
$n$             number of time periods 
--------------  ---------------------------------

Dimensions of the linear Gaussian model.

|Vector        |dim  | name |
|--------------|-----|------|
| $y_t$        | $p$ | observation vector |
| $\alpha_t$   | $m$ | state vector |
| $\epsilon_t$ | $p$ |
| $\eta_t$     | $r$ |
| $a_1$        | $m$ |
| $d_t$        | $p$ | mean adjustment |
| $c_t$        | $m$ | mean adjustment | 

  : Vectors and their dimensions
  
| Matrix       |dim     |
|--------------|--------|
| $Z_t$        | $p, m$ |
| $T_t$        | $m, m$ |
| $H_t$        | $p, p$ |
| $R_t$        | $m, r$ |
| $Q_t$        | $r, r$ |
| $R_t$        | $m, m$ |

  : Matrices and their dimensions

Let $\Psi_t$ be a set of parameters that the system matrices and vectors depend on.

$$
\begin{aligned}[t]
a_{t|t} &= E(\alpha_t | Y_t) \\
a_{t + 1} &= E(\alpha_{t + 1} | Y_t) \\
P_{t|t} &= Var(\alpha_t | Y_t) \\
P_{t+1} &= Var(\alpha_{t + 1} | Y_t)
\end{aligned}
$$
Let
$$
v_t = y_t - E(y_t | Y_{t-1}) = y_t - E(Z_t \alpha_t + \epsilon_t | Y_{t - 1}) = y_t - Z_t a_t
$$

# Filtering

(DK, Sec 4.3.2-4.3.3)

$$
\begin{aligned}[t]
v_t &= y_t - Z_t a_t - d_t & F_t &= Z_t P_t Z'_t + H_t \\
a_{t|t} &= a_t + P_t Z'_t F^{-1}_t v_t & P_{t|t} &= P_t - P_t Z'_t F^{-1}_t Z_t P_t \\
a_{t + 1} &= T_t a_t + c_t + K_t v_t & P_{t+1} &= T_t P_t (T_t - K_t Z_t)' + R_t Q_t R'_t
\end{aligned}
$$
for $t = 1, \dots, n$, where $K_t = T_t P_t Z'_t F^{-1}_t$.
Once $a_{t|t}$ and $P_{t|t}$ are computed,
$$
\begin{aligned}[t]
a_{t + 1} &= T_t a_{t|t} + c_t & P_{t + 1} &= T_t P_{t|t} T'_t + R_t Q_t R'_t
\end{aligned}
$$

| Array | dim |
|---|---|
| $v_t$ | $p$ |
| $a_t$ | $m$ |
| $a_{t|t}$ | $m$ |
| $F_t$ | $p, p$ |
| $K_t$ | $m, p$ |
| $P_t$ | $m, m$ |
| $P_{t|t}$ | $m, m$ |

## Steady Stae

If time invariant system, then $P_{t+1}$ converges to a steady state $\bar{P}$,
$$
\bar{P} = T \bar{P} T' - T \bar{P} Z' \bar{F}^{-1} Z \bar{P} T' + R Q R'
$$
where
$\bar{F} = Z \bar{P} Z' + H$. (DK, Sec 4.3.4)
